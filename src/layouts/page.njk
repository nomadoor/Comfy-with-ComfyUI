---
layout: base.njk
---
{% from "icon.njk" import icon %}
{% set currentLang = lang or site.defaultLang %}
{% set workflowI18n = site.i18n.workflow or {} %}
{% set workflowJsonHeading = workflowI18n.jsonHeading[currentLang] or workflowI18n.jsonHeading[site.defaultLang] or "Workflow JSON" %}
{% set workflowRelatedHeading = workflowI18n.relatedHeading[currentLang] or workflowI18n.relatedHeading[site.defaultLang] or "Related workflows" %}
{% set workflowCopyLabel = workflowI18n.copyLabel[currentLang] or workflowI18n.copyLabel[site.defaultLang] or "Copy" %}
{% set workflowDownloadLabel = workflowI18n.downloadLabel[currentLang] or workflowI18n.downloadLabel[site.defaultLang] or "Download" %}
{% set footerConfig = site.footer or {} %}
{% set footerTitle = footerConfig.title[currentLang] or footerConfig.title[site.defaultLang] %}
{% set footerText = footerConfig.body[currentLang] or footerConfig.body[site.defaultLang] %}
{% set footerLinks = footerConfig.links or [] %}
{% include "hero.njk" %}
<div class="article-body">
  {{ content | safe }}
</div>
{% if workflowJson and workflowJson.length %}
<section class="workflow-json">
  <h2 class="workflow-json__heading">{{ workflowJsonHeading }}</h2>
  <ul class="workflow-json__list">
    {% for workflow in workflowJson %}
      {% set fileName = (workflow.json or '') | basename %}
      <li class="workflow-json__row">
        <span class="workflow-json__filename">{{ fileName }}</span>
        <div class="workflow-json__actions">
          <button class="workflow-json__icon" type="button" aria-label="{{ workflowCopyLabel }} {{ fileName }}" data-copy-json="{{ workflow.id }}-json">
            {{ icon("copy") }}
          </button>
          <a class="workflow-json__icon" href="{{ workflow.json }}" download aria-label="{{ workflowDownloadLabel }} {{ fileName }}">
            {{ icon("download") }}
          </a>
        </div>
      </li>
      {% if workflow.copy %}
        <pre id="{{ workflow.id }}-json" class="sr-only">{{ workflow.copy | safe }}</pre>
      {% endif %}
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if section == "basic-workflows" %}
  {% set relatedPages = collections.all | relatedWorkflows(page.url, tags, lang) %}
  {% if relatedPages.length %}
    <section class="workflow-related">
      <h2 class="workflow-related__heading">{{ workflowRelatedHeading }}</h2>
      <div class="workflow-related__grid">
        {% for entry in relatedPages %}
          <a class="workflow-related__card" href="{{ entry.url }}">
            <span class="workflow-related__title">{{ entry.title }}</span>
            {% if entry.summary %}
            <span class="workflow-related__summary">{{ entry.summary }}</span>
            {% endif %}
          </a>
        {% endfor %}
      </div>
    </section>
  {% endif %}
{% endif %}

{% if footerTitle or footerText or footerLinks.length %}
  <footer class="article-footer">
    <div class="article-footer__inner">
      <div class="article-footer__copy">
        {% if footerTitle %}
          <p class="article-footer__title">{{ footerTitle }}</p>
        {% endif %}
        {% if footerText %}
          <p class="article-footer__text">{{ footerText }}</p>
        {% endif %}
      </div>
      {% if footerLinks.length %}
        <div class="article-footer__links">
          {% for link in footerLinks %}
            {% set linkLabel = link.label[currentLang] or link.label[site.defaultLang] %}
            {% if linkLabel %}
              {% if link.type == "internal" %}
                {% set href = "/" ~ currentLang ~ "/" ~ (link.section or "begin-with") ~ "/" ~ (link.slug or "") ~ "/" %}
              {% else %}
                {% set href = link.href or "#" %}
              {% endif %}
              {% set isExternal = link.type == "external" %}
              <a class="article-footer__link" href="{{ href }}" {% if isExternal %}target="_blank" rel="noreferrer noopener"{% endif %}>
                {{ linkLabel }}
              </a>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </footer>
{% endif %}
